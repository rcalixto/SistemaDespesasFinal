ATEN√á√ÉO ‚Äî EXECU√á√ÉO DE BAIXO CUSTO E M√ÅXIMA SEGURAN√áA

Quero corrigir APENAS o suporte a UPLOAD DE ANEXOS no m√≥dulo de ADIANTAMENTOS.

O objetivo √© tornar o m√≥dulo consistente com Reembolsos, Passagens e Hospedagens.

‚ö†Ô∏è ALTERAR SOMENTE OS ARQUIVOS ABAIXO:
- server/routes.ts          (somente as rotas de adiantamentos)
- client/src/pages/adiantamentos.tsx

‚ö†Ô∏è N√ÉO MEXER EM:
- server/storage.ts
- shared/schema.ts
- reembolsos, passagens, hospedagens, presta√ß√£o de adiantamento
- autentica√ß√£o
- componentes globais
- l√≥gica de workflow ou status

===========================================
üéØ OBJETIVO GERAL
Implementar upload de arquivos nos adiantamentos, usando o mesmo padr√£o que j√° existe nos m√≥dulos Reembolsos, Passagens e Hospedagens.

Isso inclui:
- aceitar multipart/form-data
- extrair req.files com multer
- extrair req.body corretamente
- salvar metadados dos arquivos no campo "anexos"
- permitir edi√ß√£o com preserva√ß√£o de anexos antigos

===========================================
üõ†Ô∏è BACKEND (server/routes.ts)
Nas rotas:

POST /api/adiantamentos  
PATCH /api/adiantamentos/:id

1. Adicionar multer:
   upload.array("anexos")

2. Tratar req.body + req.files:
   - converter campos num√©ricos
   - converter campos de data
   - se existir algum campo JSON como "itens", fazer JSON.parse(itens)

3. Construir o array de metadados EXACTAMENTE neste formato:
   {
     originalName,
     path,
     mimetype,
     size
   }

4. No PATCH:
   - preservar anexos antigos se o usu√°rio n√£o enviar novos
   - se enviar novos, concatenar com os existentes

5. N√ÉO alterar nenhuma l√≥gica de aprova√ß√£o, status ou usu√°rios.

===========================================
üõ†Ô∏è FRONTEND (client/src/pages/adiantamentos.tsx)
Na p√°gina de adiantamentos:

1. Converter o envio de JSON para envio via FormData:
   - incluir todos os campos textuais e num√©ricos
   - anexar todos os arquivos selecionados no componente de upload:
     formData.append("anexos", file);

2. Preservar anexos antigos na edi√ß√£o:
   - se n√£o houver novos anexos, enviar uma chave tipo:
     formData.append("existingAnexos", JSON.stringify(existingAnexos));

3. N√ÉO alterar a UI/UX:
   A interface est√° correta. Apenas fazer o upload funcionar.

4. N√ÉO alterar:
   - valida√ß√µes
   - componentes
   - layout
   - l√≥gica de status
   - nomenclatura dos campos
   - fluxo de cria√ß√£o/edi√ß√£o j√° existente

===========================================
üìå IMPORTANTE
N√£o quero que voc√™ reescreva a p√°gina inteira.
N√£o quero que voc√™ refatore backend.
N√£o quero que voc√™ mexa em schemas e storage.
Apenas adicione o suporte a upload no m√≥dulo de ADIANTAMENTOS.

===========================================

Pode executar SOMENTE essas mudan√ßas.
